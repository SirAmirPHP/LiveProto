# ربات شناسایی آهنگ تلگرام

این ربات تلگرام قابلیت شناسایی آهنگ از ریلزهای اینستاگرام را دارد. کاربران می‌توانند لینک ریلز اینستاگرام را ارسال کنند و ربات نام آهنگ و هنرمند را شناسایی می‌کند.

## ویژگی‌ها

- 🎵 شناسایی آهنگ از ریلزهای اینستاگرام
- 🎤 نمایش نام هنرمند و آهنگ
- 💿 نمایش اطلاعات آلبوم (در صورت موجود بودن)
- 📅 نمایش سال انتشار
- 🎯 نمایش درصد دقت شناسایی
- 💾 ذخیره تاریخچه در دیتابیس
- 🔒 امنیت بالا و محافظت از داده‌ها

## پیش‌نیازها

- PHP 7.4 یا بالاتر
- MySQL 5.7 یا بالاتر
- FFmpeg (برای استخراج صدا از ویدیو)
- Extension های PHP: curl, json, pdo, pdo_mysql
- SSL Certificate (برای webhook)

## نصب و راه‌اندازی

### 1. آپلود فایل‌ها

فایل‌های پروژه را در هاست cPanel آپلود کنید.

### 2. اجرای نصب

فایل `install.php` را در مرورگر اجرا کنید تا پیش‌نیازها بررسی شوند.

### 3. تنظیم دیتابیس

1. دیتابیس MySQL ایجاد کنید
2. فایل `config.php` را ویرایش کنید و اطلاعات دیتابیس را وارد کنید

### 4. ایجاد ربات تلگرام

1. با [@BotFather](https://t.me/botfather) در تلگرام چت کنید
2. دستور `/newbot` را ارسال کنید
3. نام و username ربات را انتخاب کنید
4. توکن ربات را کپی کنید
5. توکن را در فایل `config.php` وارد کنید

### 5. تنظیم API ها

#### Instagram Basic Display API
1. به [Facebook Developers](https://developers.facebook.com/) بروید
2. اپلیکیشن جدید ایجاد کنید
3. Instagram Basic Display را اضافه کنید
4. کلید API را دریافت کنید

#### ACRCloud API (شناسایی آهنگ)
1. به [ACRCloud](https://www.acrcloud.com/) بروید
2. حساب کاربری ایجاد کنید
3. کلید API را دریافت کنید

### 6. تنظیم Webhook

فایل `setup.php` را اجرا کنید:

```
https://yourdomain.com/setup.php?password=your_admin_password
```

### 7. تست ربات

فایل `test.php` را اجرا کنید:

```
https://yourdomain.com/test.php?password=your_admin_password
```

## استفاده

1. ربات را در تلگرام پیدا کنید
2. دستور `/start` را ارسال کنید
3. لینک ریلز اینستاگرام را ارسال کنید
4. منتظر شناسایی آهنگ بمانید

## ساختار فایل‌ها

```
/
├── config.php              # تنظیمات اصلی
├── database.php            # کلاس دیتابیس
├── instagram_handler.php   # پردازش اینستاگرام
├── music_recognizer.php    # شناسایی آهنگ
├── telegram_bot.php        # کلاس ربات تلگرام
├── webhook.php            # webhook handler
├── setup.php              # تنظیمات
├── test.php               # تست ربات
├── install.php            # نصب
├── index.php              # صفحه اصلی
└── README.md              # راهنما
```

## API های پشتیبانی شده

### شناسایی آهنگ
- **ACRCloud**: سرویس اصلی شناسایی آهنگ
- **Shazam**: جایگزین ACRCloud

### اینستاگرام
- **Instagram Basic Display API**: دسترسی به محتوای اینستاگرام

## تنظیمات پیشرفته

### محدودیت فایل
در فایل `.htaccess`:
```apache
php_value upload_max_filesize 50M
php_value post_max_size 50M
php_value max_execution_time 300
php_value memory_limit 256M
```

### امنیت
- فایل `config.php` را از دسترسی عمومی محافظت کنید
- از SSL certificate معتبر استفاده کنید
- رمزهای عبور قوی انتخاب کنید

## عیب‌یابی

### خطاهای رایج

1. **خطای اتصال به دیتابیس**
   - اطلاعات دیتابیس را بررسی کنید
   - اطمینان حاصل کنید که دیتابیس ایجاد شده است

2. **خطای FFmpeg**
   - FFmpeg را نصب کنید
   - مسیر FFmpeg را در کد تنظیم کنید

3. **خطای API**
   - کلیدهای API را بررسی کنید
   - محدودیت‌های API را در نظر بگیرید

4. **خطای Webhook**
   - SSL certificate را بررسی کنید
   - URL webhook را صحیح تنظیم کنید

## پشتیبانی

برای پشتیبانی و گزارش باگ، لطفاً با توسعه‌دهنده تماس بگیرید.

## مجوز

این پروژه تحت مجوز MIT منتشر شده است.